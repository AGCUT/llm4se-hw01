# 🚀 快速启动指?- 用户认证功能

> 5分钟快速启动并测试用户认证功能

## 📋 前提条件

?已创?Supabase 项目  
?已执行数据库 SQL（`docs/supabase数据库设?sql`? 
?已获?Supabase URL ?ANON_KEY

---

## 🎯 启动步骤

### 步骤 1: 配置环境变量?分钟?

?`frontend` 目录创建 `.env.local` 文件?

```bash
cd frontend
```

创建 `.env.local` 文件，内容如下：

```env
VITE_SUPABASE_URL=https://xxxxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGc...你的完整key
```

**获取配置的位置：**
1. 登录 Supabase Dashboard
2. 选择你的项目
3. 点击 **Settings** ?**API**
4. 复制 **Project URL** ?**anon public** key

### 步骤 2: 安装依赖?分钟?

```bash
# ?frontend 目录?
npm install
```

### 步骤 3: 启动开发服务器?分钟?

```bash
npm run dev
```

等待启动完成，会显示?

```
VITE v5.0.0  ready in 1234 ms

? Local:   http://localhost:5173/
```

### 步骤 4: 测试功能?分钟?

打开浏览器访问：

1. **首页**: http://localhost:5173
2. **注册页面**: http://localhost:5173/register
3. **登录页面**: http://localhost:5173/login

---

## ?快速测试清?

### 测试 1: 注册新用?

1. 访问 http://localhost:5173/register
2. 填写表单?
   ```
   用户? testuser
   邮箱: test@example.com
   密码: test123456
   确认密码: test123456
   ```
3. 勾?同意服务条款"
4. 点击"注册"

**预期结果:**
- ?显示"注册成功！请检查您的邮箱以验证账户"
- ?自动跳转到登录页?

### 测试 2: 登录

1. 访问 http://localhost:5173/login
2. 输入?
   ```
   邮箱: test@example.com
   密码: test123456
   ```
3. 点击"登录"

**预期结果:**
- ?登录成功
- ?自动跳转到首?
- ?可以看到用户信息

### 测试 3: 路由守卫

**未登录时:**
- 访问 http://localhost:5173/dashboard
- 预期：自动重定向?`/login`

**已登录时:**
- 访问 http://localhost:5173/login
- 预期：自动重定向?`/`

### 测试 4: 表单验证

在注册或登录页面尝试?
- [ ] 提交空表??显示错误提示
- [ ] 输入无效邮箱 ?显示"请输入有效的邮箱地址"
- [ ] 密码少于6??显示"密码长度至少??
- [ ] 两次密码不一??显示"两次密码输入不一?

---

## 🛠?使用独立测试页面

如果想快速测试所?API 功能?

### 方式 1: 直接打开 HTML（需要配置）

1. 打开 `frontend/test-auth.html`
2. 修改其中?URL ?KEY?
   ```javascript
   const SUPABASE_URL = 'https://xxxxx.supabase.co'
   const SUPABASE_ANON_KEY = 'eyJhbGc...'
   ```
3. 用浏览器打开该文?
4. 依次点击测试按钮

### 方式 2: 通过开发服务器访问（推荐）

1. 确保开发服务器已启?
2. 访问 http://localhost:5173/test-auth.html
3. 直接点击测试按钮（会自动读取环境变量?

---

## 🎨 功能演示

### 注册页面
![注册页面](https://via.placeholder.com/800x600/667eea/ffffff?text=Register+Page)

**特?**
- ?表单验证
- ?实时错误提示
- ?加载状?
- ?密码强度要求
- ?服务条款勾?

### 登录页面
![登录页面](https://via.placeholder.com/800x600/764ba2/ffffff?text=Login+Page)

**特?**
- ?邮箱和密码登?
- ?记住登录状?
- ?忘记密码链接
- ?注册跳转链接

---

## 🐛 遇到问题?

### 问题 1: 启动报错 "Missing Supabase environment variables"

**解决:**
- 检?`.env.local` 文件是否存在
- 检查变量名是否正确（必须以 `VITE_` 开头）
- **重启开发服务器**（环境变量修改后必须重启?

### 问题 2: 注册成功但无法登?

**原因:** Supabase 默认需要邮箱验?

**解决方案 A（临时开发）:**
1. Supabase Dashboard ?Authentication ?Policies
2. 取消勾?"Enable email confirmations"

**解决方案 B（生产环境）:**
1. 检查邮箱（包括垃圾箱）
2. 点击验证链接
3. 返回登录

### 问题 3: 表单提交没反?

**检?**
1. 打开浏览器控制台（F12?
2. 查看是否有错误信?
3. 检查网络请求是否发?
4. 检?Supabase URL ?KEY 是否正确

### 问题 4: 路由守卫不工?

**解决:**
1. 清除浏览?LocalStorage
2. 刷新页面
3. 重新登录

---

## 📱 浏览器兼容?

| 浏览?| 版本 | 支持 |
|--------|------|------|
| Chrome | 90+ | ?|
| Firefox | 88+ | ?|
| Safari | 14+ | ?|
| Edge | 90+ | ?|

---

## 💡 开发提?

### 在代码中使用认证

#### 获取当前用户
```tsx
import { useAuth } from '@/hooks/useAuth'

function MyComponent() {
  const { user, profile, isAuthenticated } = useAuth()
  
  return (
    <div>
      {isAuthenticated ? (
        <p>欢迎，{profile?.username}</p>
      ) : (
        <p>请登?/p>
      )}
    </div>
  )
}
```

#### 登出
```tsx
import { useAuthStore } from '@/store/authStore'

function LogoutButton() {
  const { signOut } = useAuthStore()
  
  const handleLogout = async () => {
    await signOut()
    // 自动重定向到登录?
  }
  
  return <button onClick={handleLogout}>退?/button>
}
```

---

## 📚 相关文档

- [详细使用指南](./用户认证功能使用指南.md)
- [实现总结](./用户认证功能实现总结.md)
- [环境变量配置](./环境变量配置说明.md)
- [Supabase 集成指南](./Supabase集成指南.md)

---

## ?检查清?

在继续开发之前，确保?

- [ ] Supabase 项目已创?
- [ ] 数据库表已创?
- [ ] 环境变量已配?
- [ ] 开发服务器可以启动
- [ ] 注册功能正常
- [ ] 登录功能正常
- [ ] 路由守卫工作正常
- [ ] 表单验证正常

全部完成?*恭喜?* 🎉 您可以开始实现其他功能了?

---

## 🎯 下一?

认证功能已就绪，接下来可以实现：

1. **行程管理** - 创建、查看、编辑行?
2. **费用记录** - 记录和统计旅行费?
3. **用户资料** - 编辑资料和上传头?
4. **AI 功能** - 智能行程生成

**祝您开发愉快！** 🚀

